<?xml version="1.0" encoding="Windows-874"?><!-- Generated by PBDoc 3.2.3 -->
<PBObject>
	<Name>n_cst_xmlconfig</Name>
	<ObjectType>u</ObjectType>
	<LastModified>2010-05-02T22:12:32</LastModified>
	<Generated>2010-09-23T15:15:45</Generated>
	<Ancestor>n_cst_base</Ancestor>
	<Comment>XML Configuration Service</Comment>
	<Size>7216</Size>
	<ObjectPath>c:\Users\9LordOfArt\Desktop\CAT\Program\PBService\xmlconfservice\xmlconfservice.pbl&lt;n_cst_xmlconfig.sru></ObjectPath>
	<PBLName>xmlconfservice.pbl</PBLName>
	<PBLPath>c:\Users\9LordOfArt\Desktop\CAT\Program\PBService\xmlconfservice\xmlconfservice.pbl</PBLPath>
	<Description>
XMLConfigService ใช้สำหรับอ่านค่า Configuration ทั้งหมดของโปรแกรมโดยการระบุ ConfigCode
ConfigCode คือ รหัสสำหรับจับคู่ไฟล์ XML ที่เก็บ Configuration ที่ต้องกำหนดไว้ก่อนแล้วใน XMLConfig.MapConfig
</Description>
	<Author>
Prazit (R) Jitmanozot
</Author>
	<Also>
d_config_codemap
</Also>
	<Usage>
ตัวอย่างนี้จะขอ datastore ที่โหลด configuration มาเพื่ออ่านค่าจากบางคอลัมน์

n_cst_xmlconfig lnv_config
lnv_config = create n_cst_xmlconfig
lnv_config.of_loadxml( "program.print.config" )

datastore lds_config
lds_config = lnv_config.of_getdatastore()

integer li_printpreviewflag
li_printpreviewflag = lds_config.getitemnumber( 1, "printpreview_flag" )
</Usage>
	<Version></Version>
	<HierarchyChain></HierarchyChain>
	<ObjectUses><UsesItem><Name>d_config_codemap</Name><Type>d</Type><Ancestor>dataobject</Ancestor><Path>xmlconfservice</Path></UsesItem></ObjectUses>
	<ObjectUsedBy></ObjectUsedBy>
<FunctionList>
	<Function>
<Name>of_loadxml</Name><Visibility>public</Visibility><Return>integer</Return><Desc>
สั่งให้โหลดข้อมูล XML มาพักไว้ใน Object นี้
</Desc><Usage>
n_cst_xmlconfig lnv_config
lnv_config = create n_cst_xmlconfig
lnv_config.of_loadxml( "pbservice.shrlonservice" )

datastore lds_config
lds_config = lnv_config.of_getdatastore()

li_myconfig = lds_config.getitemnumber( 1, "myconfig" )
</Usage><RetDesc>
1	=	success
-1	=	error
</RetDesc>
<ArgList>
<Arg><Name>as_configcode</Name><Type>string</Type><PassBy>value</PassBy><Desc>  รหัส Configuration ใช้จับคู่ไฟล์ XML.
</Desc></Arg></ArgList>
</Function>	<Function>
<Name>of_getdatastore</Name><Visibility>public</Visibility><Return>datastore</Return><Desc>
ขอ datastore ที่โหลด configuration ไว้แล้ว (ควรเรียกฟังชั่น of_loadxml ก่อนเสมอ)
</Desc><Usage>
n_cst_xmlconfig lnv_config
lnv_config = create n_cst_xmlconfig
lnv_config.of_loadxml( "pbservice.shrlonservice" )

datastore lds_config
lds_config = lnv_config.of_getdatastore()
...
li_myconfig = lds_config.getitemnumber( 1, "myconfig" )
</Usage><RetDesc>
ถ้าเสร็จสมบูรณ์ส่งค่ากลับเป็น Datastore ที่มี Configuration โหลดไว้แล้ว
ถ้าไม่สมบูรณ์ส่งค่ากลับเป็น null
</RetDesc></Function>	<Function>
<Name>of_getxml</Name><Visibility>public</Visibility><Return>string</Return><Desc>
ขอ XML ที่โหลดจากไฟล์ configuration (ควรเรียกฟังชั่น of_loadxml ก่อนเสมอ)
</Desc><Usage>
n_cst_xmlconfig lnv_config
lnv_config = create n_cst_xmlconfig
lnv_config.of_loadxml( "pbservice.shrlonservice" )

string ls_config
ls_config = lnv_config.of_getxml()
</Usage><RetDesc>
ถ้าเสร็จสมบูรณ์ส่งค่ากลับเป็น DatawindowXML
ถ้าไม่สมบูรณ์ส่งค่ากลับเป็น null
</RetDesc></Function>	<Function>
<Name>of_getxmlfilename</Name><Visibility>public</Visibility><Return>string</Return><Desc>
อยากรู้ชื่อไฟล์ XML ที่จับคู่กับ ConfigCode
</Desc><Usage>
n_cst_xmlconfig lnv_config
lnv_config = create n_cst_xmlconfig

string ls_xmlfile
ls_xmlfile = lnv_config.of_getxmlfilename( "pbservice.shrlonservice" )
</Usage><RetDesc>
ถ้าเสร็จสมบูรณ์ส่งค่ากลับเป็น ชื่อไฟล์ XML
ถ้าไม่สมบูรณ์ส่งค่ากลับเป็น null
</RetDesc>
<ArgList>
<Arg><Name>as_configcode</Name><Type>string</Type><PassBy>value</PassBy><Desc>	รหัส Configuration ใช้จับคู่ไฟล์ XML
</Desc></Arg></ArgList>
</Function></FunctionList>
<EventList>
	<Event>
<Name>n_cst_xmlconfig.create</Name><Control>n_cst_xmlconfig</Control><EventType>CR</EventType><Mapping></Mapping><Return></Return><Desc></Desc><Usage></Usage><RetDesc></RetDesc></Event>	<Event>
<Name>n_cst_xmlconfig.destroy</Name><Control>n_cst_xmlconfig</Control><EventType>DE</EventType><Mapping></Mapping><Return></Return><Desc></Desc><Usage></Usage><RetDesc></RetDesc></Event></EventList>
	<TypeVars><Source><![CDATA[
Public:
constant string XML_CODEMAP = "C:\GCOOP\XMLConfig\xmlconf.codemap.xml"
constant string XML_PATH = "C:\GCOOP\XMLConfig\"

Protected:
String is_configcode
String is_xmlname
Datastore ids_config
]]></Source></TypeVars>
</PBObject>